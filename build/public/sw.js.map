{"version":3,"sources":["node_modules/browser-pack/_prelude.js","public/js/sw/index.js","public/js/sw/preroll/index.js"],"names":[],"mappings":"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","file":"sw.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","var staticCacheName = 'wittr-static-v7';\nvar contentImgsCache = 'wittr-content-imgs';\nvar allCaches = [\n  staticCacheName,\n  contentImgsCache\n];\n\nself.addEventListener('install', function (event) {\n  event.waitUntil(\n    caches.open(staticCacheName).then(function (cache) {\n      return cache.addAll([\n        '/skeleton',\n        'js/main.js',\n        'css/main.css',\n        'imgs/icon.png',\n        // 'https://fonts.gstatic.com/s/roboto/v15/2UX7WLTfW3W8TclTUvlFyQ.woff',\n        // 'https://fonts.gstatic.com/s/roboto/v15/d-6IYplOFocCacKzxwXSOD8E0i7KZn-EPnyo3HZu7kw.woff'\n      ]);\n    })\n  );\n});\n\nself.addEventListener('activate', function (event) {\n  event.waitUntil(\n    caches.keys().then(function (cacheNames) {\n      return Promise.all(\n        cacheNames.filter(function (cacheName) {\n          return cacheName.startsWith('wittr-') &&\n            !allCaches.includes(cacheName);\n        }).map(function (cacheName) {\n          return caches.delete(cacheName);\n        })\n      );\n    })\n  );\n});\n\nself.addEventListener('fetch', function (event) {\n  var requestUrl = new URL(event.request.url);\n\n  if (requestUrl.origin === location.origin) {\n    if (requestUrl.pathname === '/') {\n      event.respondWith(caches.match('/skeleton'));\n      return;\n    }\n    if (requestUrl.pathname.startsWith('/photos/')) {\n      event.respondWith(servePhoto(event.request));\n      return;\n    }\n    // TODO: respond to avatar urls by responding with\n    // the return value of serveAvatar(event.request)\n    if (requestUrl.pathname.startsWith('/avatars/')) {\n      event.respondWith(serveAvatar(event.request));\n      return;\n    }\n  }\n\n  event.respondWith(\n    caches.match(event.request).then(function (response) {\n      return response || fetch(event.request);\n    })\n  );\n});\n\nfunction serveAvatar(request) {\n  // Avatar urls look like:\n  // avatars/sam-2x.jpg\n  // But storageUrl has the -2x.jpg bit missing.\n  // Use this url to store & match the image in the cache.\n  // This means you only store one copy of each avatar.\n  var storageUrl = request.url.replace(/-\\dx\\.jpg$/, '');\n\n  // TODO: return images from the \"wittr-content-imgs\" cache\n  // if they're in there. But afterwards, go to the network\n  // to update the entry in the cache.\n  //\n  // Note that this is slightly different to servePhoto!\n  return caches.open(contentImgsCache).then(function (cache) {\n    return cache.match(storageUrl).then(function (response) {\n      var networkFetch = fetch(request).then(function (networkResponse) {\n        cache.put(storageUrl, networkResponse.clone());\n        return networkResponse;\n      })\n      return response || networkFetch;\n    })\n  })\n}\n\nfunction servePhoto(request) {\n  var storageUrl = request.url.replace(/-\\d+px\\.jpg$/, '');\n\n  return caches.open(contentImgsCache).then(function (cache) {\n    return cache.match(storageUrl).then(function (response) {\n      if (response) return response;\n\n      return fetch(request).then(function (networkResponse) {\n        cache.put(storageUrl, networkResponse.clone());\n        return networkResponse;\n      });\n    });\n  });\n}\n\nself.addEventListener('message', function (event) {\n  if (event.data.action === 'skipWaiting') {\n    self.skipWaiting();\n  }\n});","var r=FetchEvent.prototype.respondWith\nFetchEvent.prototype.respondWith=function(){return new URL(this.request.url).search.endsWith(\"bypass-sw\")?void 0:r.apply(this,arguments)}"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCIvaG9tZS9nb2RmcmV5L3dpdHRyL3B1YmxpYy9qcy9zdy9pbmRleC5qcyIsIi9ob21lL2dvZGZyZXkvd2l0dHIvcHVibGljL2pzL3N3L3ByZXJvbGwvaW5kZXguanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7OztBQ0FBLElBQUksZUFBZSxHQUFHLGlCQUFpQixDQUFDO0FBQ3hDLElBQUksZ0JBQWdCLEdBQUcsb0JBQW9CLENBQUM7QUFDNUMsSUFBSSxTQUFTLEdBQUcsQ0FDZCxlQUFlLEVBQ2YsZ0JBQWdCLENBQ2pCLENBQUM7O0FBRUYsSUFBSSxDQUFDLGdCQUFnQixDQUFDLFNBQVMsRUFBRSxVQUFVLEtBQUssRUFBRTtBQUNoRCxPQUFLLENBQUMsU0FBUyxDQUNiLE1BQU0sQ0FBQyxJQUFJLENBQUMsZUFBZSxDQUFDLENBQUMsSUFBSSxDQUFDLFVBQVUsS0FBSyxFQUFFO0FBQ2pELFdBQU8sS0FBSyxDQUFDLE1BQU0sQ0FBQyxDQUNsQixXQUFXLEVBQ1gsWUFBWSxFQUNaLGNBQWMsRUFDZCxlQUFlLENBR2hCLENBQUMsQ0FBQztHQUNKLENBQUMsQ0FDSCxDQUFDO0NBQ0gsQ0FBQyxDQUFDOzs7O0FBRUgsSUFBSSxDQUFDLGdCQUFnQixDQUFDLFVBQVUsRUFBRSxVQUFVLEtBQUssRUFBRTtBQUNqRCxPQUFLLENBQUMsU0FBUyxDQUNiLE1BQU0sQ0FBQyxJQUFJLEVBQUUsQ0FBQyxJQUFJLENBQUMsVUFBVSxVQUFVLEVBQUU7QUFDdkMsV0FBTyxPQUFPLENBQUMsR0FBRyxDQUNoQixVQUFVLENBQUMsTUFBTSxDQUFDLFVBQVUsU0FBUyxFQUFFO0FBQ3JDLGFBQU8sU0FBUyxDQUFDLFVBQVUsQ0FBQyxRQUFRLENBQUMsSUFDbkMsQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFDLFNBQVMsQ0FBQyxDQUFDO0tBQ2xDLENBQUMsQ0FBQyxHQUFHLENBQUMsVUFBVSxTQUFTLEVBQUU7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QUFDO09BQ3hCLENBQUMsQ0FBQztLQUNKLENBQUMsQ0FBQztHQUNKLENBQUMsQ0FBQztDQUNKOztBQUVELElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxTQUFTLEVBQUUsVUFBVSxLQUFLLEVBQUU7QUFDaEQsTUFBSSxLQUFLLENBQUMsSUFBSSxDQUFDLE1BQU0sS0FBSyxhQUFhLEVBQUU7QUFDdkMsUUFBSSxDQUFDLFdBQVcsRUFBRSxDQUFDO0dBQ3BCO0NBQ0YsQ0FBQyxDQUFDOzs7OztBQzNHSCxJQUFJLENBQUMsR0FBQyxVQUFVLENBQUMsU0FBUyxDQUFDLFdBQVcsQ0FBQTtBQUN0QyxVQUFVLENBQUMsU0FBUyxDQUFDLFdBQVcsR0FBQyxZQUFVO0FBQUMsU0FBTyxJQUFJLEdBQUcsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsV0FBVyxDQUFDLEdBQUMsS0FBSyxDQUFDLEdBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxJQUFJLEVBQUMsU0FBUyxDQUFDLENBQUE7Q0FBQyxDQUFBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsInZhciBzdGF0aWNDYWNoZU5hbWUgPSAnd2l0dHItc3RhdGljLXY3JztcbnZhciBjb250ZW50SW1nc0NhY2hlID0gJ3dpdHRyLWNvbnRlbnQtaW1ncyc7XG52YXIgYWxsQ2FjaGVzID0gW1xuICBzdGF0aWNDYWNoZU5hbWUsXG4gIGNvbnRlbnRJbWdzQ2FjaGVcbl07XG5cbnNlbGYuYWRkRXZlbnRMaXN0ZW5lcignaW5zdGFsbCcsIGZ1bmN0aW9uIChldmVudCkge1xuICBldmVudC53YWl0VW50aWwoXG4gICAgY2FjaGVzLm9wZW4oc3RhdGljQ2FjaGVOYW1lKS50aGVuKGZ1bmN0aW9uIChjYWNoZSkge1xuICAgICAgcmV0dXJuIGNhY2hlLmFkZEFsbChbXG4gICAgICAgICcvc2tlbGV0b24nLFxuICAgICAgICAnanMvbWFpbi5qcycsXG4gICAgICAgICdjc3MvbWFpbi5jc3MnLFxuICAgICAgICAnaW1ncy9pY29uLnBuZycsXG4gICAgICAgIC8vICdodHRwczovL2ZvbnRzLmdzdGF0aWMuY29tL3Mvcm9ib3RvL3YxNS8yVVg3V0xUZlczVzhUY2xUVXZsRnlRLndvZmYnLFxuICAgICAgICAvLyAnaHR0cHM6Ly9mb250cy5nc3RhdGljLmNvbS9zL3JvYm90by92MTUvZC02SVlwbE9Gb2NDYWNLenh3WFNPRDhFMGk3S1puLUVQbnlvM0hadTdrdy53b2ZmJ1xuICAgICAgXSk7XG4gICAgfSlcbiAgKTtcbn0pO1xuXG5zZWxmLmFkZEV2ZW50TGlzdGVuZXIoJ2FjdGl2YXRlJywgZnVuY3Rpb24gKGV2ZW50KSB7XG4gIGV2ZW50LndhaXRVbnRpbChcbiAgICBjYWNoZXMua2V5cygpLnRoZW4oZnVuY3Rpb24gKGNhY2hlTmFtZXMpIHtcbiAgICAgIHJldHVybiBQcm9taXNlLmFsbChcbiAgICAgICAgY2FjaGVOYW1lcy5maWx0ZXIoZnVuY3Rpb24gKGNhY2hlTmFtZSkge1xuICAgICAgICAgIHJldHVybiBjYWNoZU5hbWUuc3RhcnRzV2l0aCgnd2l0dHItJykgJiZcbiAgICAgICAgICAgICFhbGxDYWNoZXMuaW5jbHVkZXMoY2FjaGVOYW1lKTtcbiAgICAgICAgfSkubWFwKGZ1bmN0aW9uIChjYWNoZU5hbWUpIHtcbiAgICAgICAgICByZXR1cm4gY2FjaGVzLmRlbGV0ZShjYWNoZU5hbWUpO1xuICAgICAgICB9KVxuICAgICAgKTtcbiAgICB9KVxuICApO1xufSk7XG5cbnNlbGYuYWRkRXZlbnRMaXN0ZW5lcignZmV0Y2gnLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgdmFyIHJlcXVlc3RVcmwgPSBuZXcgVVJMKGV2ZW50LnJlcXVlc3QudXJsKTtcblxuICBpZiAocmVxdWVzdFVybC5vcmlnaW4gPT09IGxvY2F0aW9uLm9yaWdpbikge1xuICAgIGlmIChyZXF1ZXN0VXJsLnBhdGhuYW1lID09PSAnLycpIHtcbiAgICAgIGV2ZW50LnJlc3BvbmRXaXRoKGNhY2hlcy5tYXRjaCgnL3NrZWxldG9uJykpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAocmVxdWVzdFVybC5wYXRobmFtZS5zdGFydHNXaXRoKCcvcGhvdG9zLycpKSB7XG4gICAgICBldmVudC5yZXNwb25kV2l0aChzZXJ2ZVBob3RvKGV2ZW50LnJlcXVlc3QpKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgLy8gVE9ETzogcmVzcG9uZCB0byBhdmF0YXIgdXJscyBieSByZXNwb25kaW5nIHdpdGhcbiAgICAvLyB0aGUgcmV0dXJuIHZhbHVlIG9mIHNlcnZlQXZhdGFyKGV2ZW50LnJlcXVlc3QpXG4gICAgaWYgKHJlcXVlc3RVcmwucGF0aG5hbWUuc3RhcnRzV2l0aCgnL2F2YXRhcnMvJykpIHtcbiAgICAgIGV2ZW50LnJlc3BvbmRXaXRoKHNlcnZlQXZhdGFyKGV2ZW50LnJlcXVlc3QpKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gIH1cblxuICBldmVudC5yZXNwb25kV2l0aChcbiAgICBjYWNoZXMubWF0Y2goZXZlbnQucmVxdWVzdCkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgIHJldHVybiByZXNwb25zZSB8fCBmZXRjaChldmVudC5yZXF1ZXN0KTtcbiAgICB9KVxuICApO1xufSk7XG5cbmZ1bmN0aW9uIHNlcnZlQXZhdGFyKHJlcXVlc3QpIHtcbiAgLy8gQXZhdGFyIHVybHMgbG9vayBsaWtlOlxuICAvLyBhdmF0YXJzL3NhbS0yeC5qcGdcbiAgLy8gQnV0IHN0b3JhZ2VVcmwgaGFzIHRoZSAtMnguanBnIGJpdCBtaXNzaW5nLlxuICAvLyBVc2UgdGhpcyB1cmwgdG8gc3RvcmUgJiBtYXRjaCB0aGUgaW1hZ2UgaW4gdGhlIGNhY2hlLlxuICAvLyBUaGlzIG1lYW5zIHlvdSBvbmx5IHN0b3JlIG9uZSBjb3B5IG9mIGVhY2ggYXZhdGFyLlxuICB2YXIgc3RvcmFnZVVybCA9IHJlcXVlc3QudXJsLnJlcGxhY2UoLy1cXGR4XFwuanBnJC8sICcnKTtcblxuICAvLyBUT0RPOiByZXR1cm4gaW1hZ2VzIGZyb20gdGhlIFwid2l0dHItY29udGVudC1pbWdzXCIgY2FjaGVcbiAgLy8gaWYgdGhleSdyZSBpbiB0aGVyZS4gQnV0IGFmdGVyd2FyZHMsIGdvIHRvIHRoZSBuZXR3b3JrXG4gIC8vIHRvIHVwZGF0ZSB0aGUgZW50cnkgaW4gdGhlIGNhY2hlLlxuICAvL1xuICAvLyBOb3RlIHRoYXQgdGhpcyBpcyBzbGlnaHRseSBkaWZmZXJlbnQgdG8gc2VydmVQaG90byFcbiAgcmV0dXJuIGNhY2hlcy5vcGVuKGNvbnRlbnRJbWdzQ2FjaGUpLnRoZW4oZnVuY3Rpb24gKGNhY2hlKSB7XG4gICAgcmV0dXJuIGNhY2hlLm1hdGNoKHN0b3JhZ2VVcmwpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICB2YXIgbmV0d29ya0ZldGNoID0gZmV0Y2gocmVxdWVzdCkudGhlbihmdW5jdGlvbiAobmV0d29ya1Jlc3BvbnNlKSB7XG4gICAgICAgIGNhY2hlLnB1dChzdG9yYWdlVXJsLCBuZXR3b3JrUmVzcG9uc2UuY2xvbmUoKSk7XG4gICAgICAgIHJldHVybiBuZXR3b3JrUmVzcG9uc2U7XG4gICAgICB9KVxuICAgICAgcmV0dXJuIHJlc3BvbnNlIHx8IG5ldHdvcmtGZXRjaDtcbiAgICB9KVxuICB9KVxufVxuXG5mdW5jdGlvbiBzZXJ2ZVBob3RvKHJlcXVlc3QpIHtcbiAgdmFyIHN0b3JhZ2VVcmwgPSByZXF1ZXN0LnVybC5yZXBsYWNlKC8tXFxkK3B4XFwuanBnJC8sICcnKTtcblxuICByZXR1cm4gY2FjaGVzLm9wZW4oY29udGVudEltZ3NDYWNoZSkudGhlbihmdW5jdGlvbiAoY2FjaGUpIHtcbiAgICByZXR1cm4gY2FjaGUubWF0Y2goc3RvcmFnZVVybCkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgIGlmIChyZXNwb25zZSkgcmV0dXJuIHJlc3BvbnNlO1xuXG4gICAgICByZXR1cm4gZmV0Y2gocmVxdWVzdCkudGhlbihmdW5jdGlvbiAobmV0d29ya1Jlc3BvbnNlKSB7XG4gICAgICAgIGNhY2hlLnB1dChzdG9yYWdlVXJsLCBuZXR3b3JrUmVzcG9uc2UuY2xvbmUoKSk7XG4gICAgICAgIHJldHVybiBuZXR3b3JrUmVzcG9uc2U7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG59XG5cbnNlbGYuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIGZ1bmN0aW9uIChldmVudCkge1xuICBpZiAoZXZlbnQuZGF0YS5hY3Rpb24gPT09ICdza2lwV2FpdGluZycpIHtcbiAgICBzZWxmLnNraXBXYWl0aW5nKCk7XG4gIH1cbn0pOyIsInZhciByPUZldGNoRXZlbnQucHJvdG90eXBlLnJlc3BvbmRXaXRoXG5GZXRjaEV2ZW50LnByb3RvdHlwZS5yZXNwb25kV2l0aD1mdW5jdGlvbigpe3JldHVybiBuZXcgVVJMKHRoaXMucmVxdWVzdC51cmwpLnNlYXJjaC5lbmRzV2l0aChcImJ5cGFzcy1zd1wiKT92b2lkIDA6ci5hcHBseSh0aGlzLGFyZ3VtZW50cyl9Il19"}